--------------- DIM CAR ---------------

--------------- day 1 ---------------

INSERT INTO DIM_CAR (VIN_CODE, MODEL, ISSUE_YEAR, BRAND)
VALUES
('3QWDJF48FSH34924F', 'M3', '2006-03-12', 'BMW');

INSERT INTO DIM_CAR (VIN_CODE, MODEL, ISSUE_YEAR, BRAND)
VALUES
('45WDJF48DHL34924F', 'RS6', '2016-05-23', 'Audi');

UPDATE DIM_CAR	-- UPDATE BMW
SET MODEL = 'M5'
WHERE VIN_CODE = '3QWDJF48FSH34924F';

INSERT INTO DIM_CAR (VIN_CODE, MODEL, ISSUE_YEAR, BRAND)
VALUES
('78KCVF23DSH67924F', 'Urus', '2020-07-10', 'Lamborghini');


--------------- day 2 ---------------

UPDATE DIM_CAR	-- UPDATE Audi
SET MODEL = 'RS5'
WHERE VIN_CODE = '45WDJF48DHL34924F';


UPDATE DIM_CAR	-- UPDATE Lamborghini
SET MODEL = 'Aventador'
WHERE VIN_CODE = '78KCVF23DSH67924F';


UPDATE DIM_CAR	-- UPDATE Audi
SET ISSUE_YEAR = '2019-05-07'
WHERE VIN_CODE = '45WDJF48DHL34924F';


--------------- day 3 ---------------

UPDATE DIM_CAR	-- UPDATE BMW
SET MODEL = 'M4'
WHERE VIN_CODE = '3QWDJF48FSH34924F';

INSERT INTO DIM_CAR (VIN_CODE, MODEL, ISSUE_YEAR, BRAND)
VALUES
('97HFBF23DDS67356G', '250 GTO', '1963-05-23', 'Ferrari');

UPDATE DIM_CAR	-- UPDATE Lamborghini
SET MODEL = 'Huracan'
WHERE VIN_CODE = '78KCVF23DSH67924F';


--------------- DIM MANAGER ---------------

--------------- day 1 ---------------

INSERT INTO DIM_MANAGER (EMP_CODE, FIRSTNAME, LASTNAME, DEPT, HIRE_DATE)
VALUES
('AB1', 'Alexandr', 'Ivanov', 'ABC', '2021-03-05');

UPDATE DIM_MANAGER	-- UPDATE Alexandr
SET HIRE_DATE = '2020-03-05'
WHERE EMP_CODE = 'AB1';

INSERT INTO DIM_MANAGER (EMP_CODE, FIRSTNAME, LASTNAME, DEPT, HIRE_DATE)
VALUES
('CD5', 'Alexey', 'Smirnov', 'DEF', '2020-05-16');

UPDATE DIM_MANAGER 	-- UPDATE Alexey
SET HIRE_DATE = '2020-12-16'
WHERE EMP_CODE = 'CD5';


--------------- day 2 ---------------

UPDATE DIM_MANAGER	-- UPDATE Alexandr
SET DEPT = 'CVB'
WHERE EMP_CODE = 'AB1';

UPDATE DIM_MANAGER 	-- UPDATE Alexey
SET DEPT = 'CVB'
WHERE EMP_CODE = 'CD5';

INSERT INTO DIM_MANAGER (EMP_CODE, FIRSTNAME, LASTNAME, DEPT, HIRE_DATE)
VALUES
('KG7', 'Pavel', 'Belov', 'CDD', '2018-08-27');

UPDATE DIM_MANAGER 	-- UPDATE Pavel
SET HIRE_DATE = '2017-10-16'
WHERE EMP_CODE = 'KG7';

--------------- day 3 ---------------

UPDATE DIM_MANAGER	-- UPDATE Pavel
SET DEPT = 'AB1'
WHERE EMP_CODE = 'KG7';

UPDATE DIM_MANAGER 	-- UPDATE Alexey
SET DEPT = 'AB1'
WHERE EMP_CODE = 'CD5';

--------------- DIM CLIENT ---------------

------------------ day 1 ------------------

INSERT INTO DIM_CLIENT (PASS_CODE, FIRSTNAME, LASTNAME, BIRTHDAY, TEL, CITY, EMAIL)
VALUES
('MB7', 'Dmitry', 'Petrov', '1998-03-05', '+375 29 007 07 07', 'Minsk', 'dmitry@client.com');

UPDATE DIM_CLIENT -- UPDATE Dmitry
SET CITY = 'Brest'
WHERE PASS_CODE = 'MB7';

UPDATE DIM_CLIENT -- UPDATE Dmitry
SET TEL = '+375 77 777 77 77'
WHERE PASS_CODE = 'MB7';


INSERT INTO DIM_CLIENT (PASS_CODE, FIRSTNAME, LASTNAME, BIRTHDAY, TEL, CITY, EMAIL)
VALUES
('RT7', 'Maxim', 'Sokolov', '1980-05-23', '+375 29 887 87 87', 'Minsk', 'maxim@client.com');


--------------- day 2 ---------------

INSERT INTO DIM_CLIENT (PASS_CODE, FIRSTNAME, LASTNAME, BIRTHDAY, TEL, CITY, EMAIL)
VALUES
('DC7', 'Egor', 'Orlov', '2000-11-25', '+375 27 333 33 33', 'Grodno', 'egor@client.com');

UPDATE DIM_CLIENT -- UPDATE Dmitry
SET TEL = '+375 73 373 73 73'
WHERE PASS_CODE = 'MB7';

UPDATE DIM_CLIENT -- UPDATE Maxim
SET TEL = '+375 37 737 33 77'
WHERE PASS_CODE = 'RT7';

UPDATE DIM_CLIENT -- UPDATE Egor
SET CITY = 'Vitebsk'
WHERE PASS_CODE = 'DC7';


--------------- day 3 ---------------

UPDATE DIM_CLIENT -- UPDATE Egor
SET CITY = 'Minsk'
WHERE PASS_CODE = 'DC7';

UPDATE DIM_CLIENT -- UPDATE Maxim
SET CITY = 'Vitebsk'
WHERE PASS_CODE = 'RT7';


--------------- DIM STORAGE ---------------

------------------ day 1 ------------------

INSERT INTO DIM_STORAGE (CITY, STREET, BUILDING, TEL, PARKING_LOT_COUNT, AREA)
VALUES
('Minsk', 'Some street 1', '39', '+375 29 777 00 88', 100, 350);

INSERT INTO DIM_STORAGE (CITY, STREET, BUILDING, TEL, PARKING_LOT_COUNT, AREA)
VALUES
('Minsk', 'Some street 2', '10', '+375 29 707 07 70', 160, 570);

INSERT INTO DIM_STORAGE (CITY, STREET, BUILDING, TEL, PARKING_LOT_COUNT, AREA)
VALUES
('Minsk', 'Some street 3', '156', '+375 29 887 07 07', 170, 630);

UPDATE DIM_STORAGE 
SET STREET = 'New street 3'
WHERE STORAGE_ID = 3;


--------------- day 2 ---------------

UPDATE DIM_STORAGE 
SET PARKING_LOT_COUNT = 180
WHERE STORAGE_ID = 2;

UPDATE DIM_STORAGE 
SET AREA = 500
WHERE STORAGE_ID = 1;

INSERT INTO DIM_STORAGE (CITY, STREET, BUILDING, TEL, PARKING_LOT_COUNT, AREA)
VALUES
('Vitebsk', 'Some street 4', '156', '+375 11 111 11 17', 155, 550);

UPDATE DIM_STORAGE 
SET STREET = 'New street 4'
WHERE STORAGE_ID = 4;


--------------- day 3 ---------------

UPDATE DIM_STORAGE 
SET PARKING_LOT_COUNT = 410
WHERE STORAGE_ID = 2;

INSERT INTO DIM_STORAGE (CITY, STREET, BUILDING, TEL, PARKING_LOT_COUNT, AREA)
VALUES
('Grodno', 'Some street 5', '17', '+375 12 112 12 17', 165, 290);

UPDATE DIM_STORAGE 
SET AREA = 310
WHERE STORAGE_ID = 5;


--------------- DIM DATE ---------------

------------------ day 1 ------------------

INSERT INTO DIM_DATE (MONTH, DAY_OF_WEEK, QUARTER, WEEK_OF_YEAR, IS_HOL)
VALUES
(12, 7, 1, 25, FALSE);

INSERT INTO DIM_DATE (MONTH, DAY_OF_WEEK, QUARTER, WEEK_OF_YEAR, IS_HOL)
VALUES
(10, 5, 2, 36, FALSE);

-- UPDATE  DIM_DATE -- ERROR (TYPE 0)
-- SET MONTH = 5
-- WHERE DATE_ID = 2;

------------------ day 2 ------------------

INSERT INTO DIM_DATE (MONTH, DAY_OF_WEEK, QUARTER, WEEK_OF_YEAR, IS_HOL)
VALUES
(5, 3, 3, 36, TRUE);

INSERT INTO DIM_DATE (MONTH, DAY_OF_WEEK, QUARTER, WEEK_OF_YEAR, IS_HOL)
VALUES
(1, 5, 2, 15, FALSE);


------------------ day 3 ------------------

INSERT INTO DIM_DATE (MONTH, DAY_OF_WEEK, QUARTER, WEEK_OF_YEAR, IS_HOL)
VALUES
(3, 4, 4, 45, TRUE);


--------------- DIM SHOW ROOM ---------------

------------------ day 1 ------------------

INSERT INTO DIM_SHOW_ROOM (SHOW_ROOM_NAME, CITY, STREET, BUILDING, CURRENT_TEL)
VALUES
('ROOM1', 'Minsk', 'Some street 10', '11', '+375 77 000 00 77');

INSERT INTO DIM_SHOW_ROOM (SHOW_ROOM_NAME, CITY, STREET, BUILDING, CURRENT_TEL)
VALUES
('ROOM2', 'Minsk', 'Some street 11', '11', '+375 77 777 00 77');

UPDATE DIM_SHOW_ROOM	-- UPDATE ROOM1 
SET CURRENT_TEL = '+375 77 000 00 00'
WHERE SHOW_ROOM_NAME = 'ROOM1';

UPDATE DIM_SHOW_ROOM	-- UPDATE ROOM2
SET CURRENT_TEL = '+375 29 777 33 33'
WHERE SHOW_ROOM_NAME = 'ROOM2';


------------------ day 2 ------------------

INSERT INTO DIM_SHOW_ROOM (SHOW_ROOM_NAME, CITY, STREET, BUILDING, CURRENT_TEL)
VALUES
('ROOM3', 'Brest', 'Some street 12', '77', '+375 11 001 01 07');

UPDATE DIM_SHOW_ROOM	-- UPDATE ROOM1 
SET CURRENT_TEL = '+375 00 010 00 00'
WHERE SHOW_ROOM_NAME = 'ROOM1';

UPDATE DIM_SHOW_ROOM	-- UPDATE ROOM3
SET CURRENT_TEL = '+375 29 000 73 70'
WHERE SHOW_ROOM_NAME = 'ROOM3';


------------------ day 3 ------------------

UPDATE DIM_SHOW_ROOM	-- UPDATE ROOM2 
SET CURRENT_TEL = '+375 00 017 70 07'
WHERE SHOW_ROOM_NAME = 'ROOM2';

INSERT INTO DIM_SHOW_ROOM (SHOW_ROOM_NAME, CITY, STREET, BUILDING, CURRENT_TEL)
VALUES
('ROOM4', 'Grodno', 'Some street 14', '17', '+375 55 555 77 55');

UPDATE DIM_SHOW_ROOM	-- UPDATE ROOM4
SET CURRENT_TEL = '+375 77 555 77 55'
WHERE SHOW_ROOM_NAME = 'ROOM4';


--------------- DIM SNAPSHOT DATE ---------------

INSERT INTO SNAPSHOT_DATE (YEAR, MONTH, DAY, FULL_DATE, TIME)
VALUES
(2021, 10, 26, '2021-10-26', CURRENT_TIME);

INSERT INTO SNAPSHOT_DATE (YEAR, MONTH, DAY, FULL_DATE, TIME)
VALUES
(2021, 9, 17, '2021-09-17', CURRENT_TIME);

INSERT INTO SNAPSHOT_DATE (YEAR, MONTH, DAY, FULL_DATE, TIME)
VALUES
(2021, 5, 7, '2021-05-07', CURRENT_TIME);

INSERT INTO SNAPSHOT_DATE (YEAR, MONTH, DAY, FULL_DATE, TIME)
VALUES
(2021, 6, 23, '2021-06-23', CURRENT_TIME);

INSERT INTO SNAPSHOT_DATE (YEAR, MONTH, DAY, FULL_DATE, TIME)
VALUES
(2021, 6, 27, '2021-06-27', CURRENT_TIME);

--------------- DIM MF_ORDER DATE ---------------

INSERT INTO MF_ORDER_DATE (YEAR, MONTH, DAY, FULL_DATE, TIME)
VALUES
(2021, 2, 16, '2021-02-16', CURRENT_TIME);

INSERT INTO MF_ORDER_DATE (YEAR, MONTH, DAY, FULL_DATE, TIME)
VALUES
(2021, 5, 18, '2021-05-18', CURRENT_TIME);

INSERT INTO MF_ORDER_DATE (YEAR, MONTH, DAY, FULL_DATE, TIME)
VALUES
(2021, 3, 19, '2021-03-19', CURRENT_TIME);

INSERT INTO MF_ORDER_DATE (YEAR, MONTH, DAY, FULL_DATE, TIME)
VALUES
(2021, 10, 23, '2021-10-23', CURRENT_TIME);


--------------- DIM ST_DELIVERY DATE ---------------

INSERT INTO ST_DELIVERY_DATE (YEAR, MONTH, DAY, FULL_DATE, TIME)
VALUES
(2021, 2, 18, '2021-02-18', CURRENT_TIME);

INSERT INTO ST_DELIVERY_DATE (YEAR, MONTH, DAY, FULL_DATE, TIME)
VALUES
(2021, 5, 19, '2021-05-19', CURRENT_TIME);

INSERT INTO ST_DELIVERY_DATE (YEAR, MONTH, DAY, FULL_DATE, TIME)
VALUES
(2021, 3, 23, '2021-03-23', CURRENT_TIME);

INSERT INTO ST_DELIVERY_DATE (YEAR, MONTH, DAY, FULL_DATE, TIME)
VALUES
(2021, 10, 25, '2021-10-25', CURRENT_TIME);

--------------- DIM CLIENT_ORDER DATE ---------------

INSERT INTO CLIENT_ORDER_DATE (YEAR, MONTH, DAY, FULL_DATE, TIME)
VALUES
(2021, 2, 14, '2021-02-14', CURRENT_TIME);

INSERT INTO CLIENT_ORDER_DATE (YEAR, MONTH, DAY, FULL_DATE, TIME)
VALUES
(2021, 5, 17, '2021-05-17', CURRENT_TIME);

INSERT INTO CLIENT_ORDER_DATE (YEAR, MONTH, DAY, FULL_DATE, TIME)
VALUES
(2021, 3, 16, '2021-03-16', CURRENT_TIME);

INSERT INTO CLIENT_ORDER_DATE (YEAR, MONTH, DAY, FULL_DATE, TIME)
VALUES
(2021, 10, 20, '2021-10-20', CURRENT_TIME);

--------------- DIM CLIENT_DELIVERY DATE ---------------

INSERT INTO CLIENT_DELIVERY_DATE (YEAR, MONTH, DAY, FULL_DATE, TIME)
VALUES
(2021, 2, 20, '2021-02-20', CURRENT_TIME);

INSERT INTO CLIENT_DELIVERY_DATE (YEAR, MONTH, DAY, FULL_DATE, TIME)
VALUES
(2021, 5, 21, '2021-05-21', CURRENT_TIME);

INSERT INTO CLIENT_DELIVERY_DATE (YEAR, MONTH, DAY, FULL_DATE, TIME)
VALUES
(2021, 3, 27, '2021-03-27', CURRENT_TIME);

INSERT INTO CLIENT_DELIVERY_DATE (YEAR, MONTH, DAY, FULL_DATE, TIME)
VALUES
(2021, 10, 27, '2021-10-27', CURRENT_TIME);


--------------- FACT SALES ---------------

INSERT INTO FACT_SALES (SK_CAR, SK_CLIENT, SK_MANAGER, SK_SALES_DATE, SK_SHOW_ROOM, PRICE)
VALUES
(3, 11, 11, 1, 1, 50000);

INSERT INTO FACT_SALES (SK_CAR, SK_CLIENT, SK_MANAGER, SK_SALES_DATE, SK_SHOW_ROOM, PRICE)
VALUES
(7, 14, 16, 2, 3, 55000);

INSERT INTO FACT_SALES (SK_CAR, SK_CLIENT, SK_MANAGER, SK_SALES_DATE, SK_SHOW_ROOM, PRICE)
VALUES
(6, 16, 14, 3, 2, 60000);

INSERT INTO FACT_SALES (SK_CAR, SK_CLIENT, SK_MANAGER, SK_SALES_DATE, SK_SHOW_ROOM, PRICE)
VALUES
(9, 20, 19, 4, 4, 1000000);

-- INSERT INTO FACT_SALES (SK_CAR, SK_CLIENT, SK_MANAGER, SK_SALES_DATE, SK_SHOW_ROOM, PRICE)
-- VALUES
-- (
-- 	(SELECT SK_CAR 
-- 	FROM DIM_CAR 
-- 	WHERE VIN_CODE = '97HFBF23DDS67356G'
-- 	AND IS_CURRENT = 1),
-- 	10, 9, 4, 4, 1000000);


--------------- FACT STORAGE SNAPSHOT ---------------

INSERT INTO FACT_STORAGE_SNAPSHOT (SK_CAR, SK_STORAGE, SK_SNAPSHOT_DATE, DAYS_ON_STORAGE)
VALUES
(3, 1, 1, 10);

INSERT INTO FACT_STORAGE_SNAPSHOT (SK_CAR, SK_STORAGE, SK_SNAPSHOT_DATE, DAYS_ON_STORAGE)
VALUES
(6, 2, 2, 15);

INSERT INTO FACT_STORAGE_SNAPSHOT (SK_CAR, SK_STORAGE, SK_SNAPSHOT_DATE, DAYS_ON_STORAGE)
VALUES
(7, 3, 3, 17);

INSERT INTO FACT_STORAGE_SNAPSHOT (SK_CAR, SK_STORAGE, SK_SNAPSHOT_DATE, DAYS_ON_STORAGE)
VALUES
(8, 4, 4, 19);

INSERT INTO FACT_STORAGE_SNAPSHOT (SK_CAR, SK_STORAGE, SK_SNAPSHOT_DATE, DAYS_ON_STORAGE)
VALUES
(10, 5, 5, 5);


--------------- FACT SALES PIPELINE ---------------

INSERT INTO FACT_SALES_PIPELINE (SK_CAR, SK_CLIENT, SK_STORAGE, SK_MF_ORDER_DATE,
						SK_ST_DELIVERY_DATE, SK_CLIENT_ORDER_DATE, 
						SK_CLIENT_DELIVERY_DATE, MF_PRICE,
						DAYS_BTW_CLNT_ORDER_DLVRY)
VALUES
(3, 11, 1, 1, 1, 1, 1, 50000,
 (SELECT DATE_PART('day', CLIENT_DELIVERY_DATE.FULL_DATE::timestamp 
				   - CLIENT_ORDER_DATE.FULL_DATE::timestamp)
 FROM CLIENT_ORDER_DATE
 JOIN CLIENT_DELIVERY_DATE
 ON  SK_CLIENT_ORDER_DATE = SK_CLIENT_DELIVERY_DATE
 WHERE SK_CLIENT_ORDER_DATE = 1)
 );

INSERT INTO FACT_SALES_PIPELINE (SK_CAR, SK_CLIENT, SK_STORAGE, SK_MF_ORDER_DATE,
						SK_ST_DELIVERY_DATE, SK_CLIENT_ORDER_DATE, 
						SK_CLIENT_DELIVERY_DATE, MF_PRICE,
						DAYS_BTW_CLNT_ORDER_DLVRY)
VALUES
(7, 14, 2, 2, 2, 2, 2, 55000,
 (SELECT DATE_PART('day', CLIENT_DELIVERY_DATE.FULL_DATE::timestamp 
				   - CLIENT_ORDER_DATE.FULL_DATE::timestamp)
 FROM CLIENT_ORDER_DATE
 JOIN CLIENT_DELIVERY_DATE
 ON  SK_CLIENT_ORDER_DATE = SK_CLIENT_DELIVERY_DATE
 WHERE SK_CLIENT_ORDER_DATE = 2)
 );

INSERT INTO FACT_SALES_PIPELINE (SK_CAR, SK_CLIENT, SK_STORAGE, SK_MF_ORDER_DATE,
						SK_ST_DELIVERY_DATE, SK_CLIENT_ORDER_DATE, 
						SK_CLIENT_DELIVERY_DATE, MF_PRICE,
						DAYS_BTW_CLNT_ORDER_DLVRY)
VALUES
(6, 16, 3, 3, 3, 3, 3, 60000,
 (SELECT DATE_PART('day', CLIENT_DELIVERY_DATE.FULL_DATE::timestamp 
				   - CLIENT_ORDER_DATE.FULL_DATE::timestamp)
 FROM CLIENT_ORDER_DATE
 JOIN CLIENT_DELIVERY_DATE
 ON  SK_CLIENT_ORDER_DATE = SK_CLIENT_DELIVERY_DATE
 WHERE SK_CLIENT_ORDER_DATE = 3)
 );


INSERT INTO FACT_SALES_PIPELINE (SK_CAR, SK_CLIENT, SK_STORAGE, SK_MF_ORDER_DATE,
						SK_ST_DELIVERY_DATE, SK_CLIENT_ORDER_DATE, 
						SK_CLIENT_DELIVERY_DATE, MF_PRICE,
						DAYS_BTW_CLNT_ORDER_DLVRY)
VALUES
(9, 20, 4, 4, 4, 4, 4, 1000000,
 (SELECT DATE_PART('day', CLIENT_DELIVERY_DATE.FULL_DATE::timestamp 
				   - CLIENT_ORDER_DATE.FULL_DATE::timestamp)
 FROM CLIENT_ORDER_DATE
 JOIN CLIENT_DELIVERY_DATE
 ON  SK_CLIENT_ORDER_DATE = SK_CLIENT_DELIVERY_DATE
 WHERE SK_CLIENT_ORDER_DATE = 4)
 );



