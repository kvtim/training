CREATE PROCEDURE to_city_names ()
LANGUAGE SQL
BEGIN
 DECLARE c1 CURSOR WITH RETURN FOR 
  SELECT CITY, (COALESCE(NAME1, '') || COALESCE((',' || NAME2), '') || COALESCE((',' || NAME3), '')) AS NAMES
  FROM CITY_N1N2N3;
 OPEN c1;
END @